var KObservableData=function(){var E=function(){return function(B,u,A){function n(a,d,c,f,D,b){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=d;this.arguments=b;this.type=c;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=f;this.oldValue=D}function q(a,d,c,f){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=
!0};this.type=a;this.key=d;this.event=c;this.args=f}function x(a,d){var c=e[d];return function(d,D){var b=new n(this,h(c)?d:"",a,h(c)?this[d]:"",h(c)?this[d]:"",arguments),b=new q(a,h(c)?d:"",b,arguments),g;!0!==k(b)&&(h(c)?(void 0===c[b.key]&&(c[b.key]=[]),g=c[b.key],g.push(b.args[1])):v(c)&&(void 0===c["*"]&&(c["*"]=[]),g=b.args[1]&&"*"===b.args[1]?c["*"]:c,g.push(b.args[0])));return this}}function t(a,d){var c=e[d];return function(d,b){var g=new n(this,d,a,this[d],this[d],arguments),g=new q(a,
d,g,arguments),y;if(!0!==k(g))if(h(c)){if(y=c[g.key])for(var e=0,l=y.length;e<l;e++)if(y[e].toString()===g.args[1].toString()){y.splice(e,1);break}}else if(v(c))for(void 0===c["*"]&&(c["*"]=[]),y=g.args[1]&&"*"===g.args[1]?c["*"]:c,e=0,l=y.length;e<l;e++)if(y[e].toString()===g.args[0].toString()){y.splice(e,1);break}return this}}function h(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function v(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}
function z(a,d,c){return{get:function(){return a[d]},set:function(c){a[d]=c},enumerable:c.enumerable,configurable:c.configurable}}function b(a,d,c){return{value:a,writable:!!d,enumerable:!1,configurable:!!c}}function g(a,d){var c=a,f=a,b=function(a,d){f=c;c=a;d.listener="__kbupdatelisteners";d.type="update";r(d)};return{get:function(){return c},set:function(a,g){var k=new n(this,d,"set",a,c,arguments,"__kblisteners");g?b(a,k):!0!==r(k)&&(b(a,k),this.callSubscribers(d,c,f))},configurable:!0,enumerable:!0}}
var e=[],m={},p={splice:[],postsplice:[],push:[],postpush:[],pop:[],postpop:[],shift:[],postshift:[],unshift:[],postunshift:[],fill:[],postfill:[],reverse:[],postreverse:[],sort:[],postsort:[],add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],addDataListener:[],removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},k=function(a){for(var d=0,c=p[a.type],f=c.length;d!==
f&&(c[d](a),!a._stopPropogration);d++);return a._preventDefault},l=function(a,d){if(!d._stopPropogration&&a)for(var c=0,f=a.length;c!==f&&(a[c](d),!d._stopPropogration);c++);},r=function(a){var d=a.local[a.listener];h(d)?(l(d[a.key],a),"__kblisteners"===a.listener?(l(d["*"],a),a.fromListener="__kblisteners",a.listener="__kbparentlisteners",l(a.local[a.listener][a.key],a),l(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(l(d["*"],a),a.fromListener="__kbupdatelisteners",a.listener=
"__kbparentupdatelisteners",l(a.local[a.listener][a.key],a),l(a.local[a.listener]["*"],a))):v(d)&&(l(d,a),l(d["*"],a));return a._preventDefault};Object.defineProperties(e,{__kbname:b(B||"",!0,!0),__kbref:b(u?u.__kbref||u:e,!0,!0),__kbscopeString:b(A||"",!0,!0),__kbImmediateParent:b(u||null,!0,!0),splice:b(function(a,d,c){var f=new n(this,a,"splice",this[a],void 0,arguments,"__kbdatadeletelisteners"),b=new q("splice",a,f,arguments);if(!0!==k(b)){var e=[],l=v(b.args[2]),m=void 0!==b.args[2]?l?b.args[2].length:
1:0,h=0;if(0!==d&&void 0!==this[b.key-1+b.args[1]]){for(var p=0,t=b.args[1];p<t;p++)if(h=b.key+p,f.key=h,f.type="remove",f.value=this[h],!0!==r(f)){e.push(this[h-e.length]);for(var w=b.key,u=this.length-1;w<u;w++)this[w]=this[w+1]}else--b.args[1];this.length-=b.args[1]}if(0!==m)for(l||(b.args[2]=[b.args[2]]),p=0,t=m;p<t;p++)if(h=b.key+p,f.key=h,f.type="add",f.listener="__kbdatacreatelisteners",f.value=b.args[2][p],!0!==r(f)){w=this.length;for(u=h;w>u;w--)void 0===this[w]?Object.defineProperty(this,
w,g.call(this,this[w-1],w)):this[w]=this[w-1];this[h]=b.args[2][p]}b.type="postsplice";k(b)}return e}),push:b(function(a){var d=new n(this,this.length,"push",a,void 0,arguments,"__kbdatacreatelisteners"),c=new q("push",this.length,d,arguments);!0!==k(c)&&(d.type="add",d.value=c.args[0],d.key=c.key,!0!==r(d)&&(Object.defineProperty(this,c.key,g.call(this,c.args[0],c.key)),c.type="postpush",k(c)));return this.length}),pop:b(function(){var a=new n(this,this.length-1,"pop",this[this.length-1],void 0,
arguments,"__kbdatadeletelisteners"),d=new q("pop",this.length-1,a,arguments);if(!0!==k(d)){var c=this[this.length-1];a.type="remove";if(!0!==r(a))return--this.length,d.type="postpop",k(d),c}return null}),shift:b(function(){var a=new n(this,0,"shift",this[0],void 0,arguments,"__kbdatadeletelisteners"),d=new q("shift",0,a,arguments);if(!0!==k(d)){var c=this[d.key];a.type="remove";a.key=d.key;if(!0!==r(a)){for(var a=d.key,f=this.length-1;a<f;a++)this[a]=this[a+1];--this.length;d.type="postshift";k(d);
return c}}return null}),unshift:b(function(){var a=new n(this,0,"unshift",this[0],void 0,arguments,"__kbdatacreatelisteners"),d=new q("unshift",0,a,arguments);if(!0!==k(d)){for(var c=Array.prototype.slice.call(d.args),f=0,b=c.length;f<b;f++)a.key=f,a.type="add",a.value=c[f],!0===r(a)&&c.splice(f,1);if(0!==c.length){f=this.length-1+c.length;for(b=c.length;-1!==f;f--)f<b?this[f]=c[f]:void 0!==Object.getOwnPropertyDescriptor(this,f).value?Object.defineProperty(this,f,g.call(this,this[f-c.length],f)):
this[f]=this[f-c.length];d.type="postunshift";k(d)}}return this.length}),fill:b(function(a,d,c){var f=void 0!==d?Math.max(0,d):0,b=new n(this,f,"fill",a,this[f],arguments,"__kbdatalisteners"),f=new q("fill",f,b,arguments);if(!0!==k(f)){for(b=f.key;b<f.args[2];b++)this[b]=f.args[0];f.type="postfill";k(f)}return this}),reverse:b(function(){var a=new n(this,0,"reverse",value,this[_start],arguments,"__kbdatalisteners"),a=new q("reverse",0,a,arguments);if(!0!==k(a)){for(var d=this.slice().reverse(),c=
0,f=this.length;c<f;c++)this[c]=d[c];a.type="postreverse";k(a)}return this}),sort:b(function(){var a=new n(this,0,"sort",value,this[_start],arguments,"__kbdatalisteners"),a=new q("sort",0,a,arguments);if(!0!==k(a)){for(var d=this.slice(),d=d.sort.apply(d,arguments),c=0,f=this.length;c<f;c++)this[c]=d[c];a.type="postsort";k(a)}return this}),add:b(function(a,d){var c=new n(this,d,"add",a,void 0,arguments,"__kbdatacreatelisteners"),f=new q("add",d,c,arguments);void 0===d?this.push(a):!0!==k(f)&&(void 0===
this[f.key]?!0!==r(c)&&(Object.defineProperty(this,f.key,g.call(this,f.args[0],f.key)),f.type="postadd",k(f)):console.error("Your attempting to add the index: ",f.key," that already exists on",this,"try using set or direct set instead"));return this}),prototype:b(function(a,d){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(d,!0,!0)):console.error("Your attempting to add your prototype with the prop: ",a," that already exists");return this}),addPointer:b(function(a,d,c){var f=new n(this,
c||d,"add",a[d],void 0,arguments,"__kbdatacreatelisteners"),b=new q("add",c||d,f,arguments);!0!==k(b)&&!0!==r(f)&&(f=Object.getOwnPropertyDescriptor(a,d),Object.defineProperty(this,b.key,z(a,d,f)),b.type="postadd",k(b));return this}),set:b(function(a,d,c){var f=new n(this,a,"set",d,this[a],arguments,"__kblisteners"),b=new q("set",a,f,arguments);void 0===this[a]?this.add(d,a):!0!==k(b)&&(f.key=b.key,f.value=b.args[1],!0!==r(f)&&(void 0===Object.getOwnPropertyDescriptor(this,b.key).value?Object.getOwnPropertyDescriptor(this,
b.key).set(b.args[1],c):Object.defineProperty(this,b.key,g.call(this,b.args[1],b.key)),b.type="postset",k(b)));return this}),remove:b(function(a,d){var c=new n(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),c=new q("remove",a,c,arguments);if(!0!==k(c)){if(void 0===this[c.key])return console.error("Your attempting to remove the index: ",c.key," that does not exist on ",this),this;this.splice(c.key,c.args[1])}return this}),stringify:b(function(){var a=[];return JSON.stringify(this,
function(d,c){if(v(c)||h(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,d,c){if(void 0!==m[a]){c=0;for(var b=m[a].length;c<b;c++)m[a][c](d)}return this}),subscribe:b(function(a,d){void 0===m[a]&&(m[a]=[]);m[a].push(d);return this}),unsubscribe:b(function(a,d){if(void 0!==m[a]){var c=0,b=m[a].length;a:for(;c<b;c++)if(m[a][c].toString()===d.toString()){m[a].splice(c,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),
__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,d){-1!==Object.keys(p).indexOf(a)?p[a].push(d):console.error("There is no action listener by the name: ",a);return this}),removeActionListener:b(function(a,d){if(-1!==Object.keys(p).indexOf(a))for(var c=0,b=p[a],g=b.length;c!==g;c++){if(b[c].toString()===d.toString()){b.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this})});Object.defineProperties(e,
{addDataListener:b(x("__kblisteners")),removeDataListener:b(t("__kblisteners")),addDataUpdateListener:b(x("__kbupdatelisteners")),removeDataUpdateListener:b(t("__kbupdatelisteners")),addDataCreateListener:b(x("__kbdatacreatelisteners")),removeDataCreateListener:b(t("__kbdatacreatelisteners")),addDataRemoveListener:b(x("__kbdatadeletelisteners")),removeDataRemoveListener:b(t("__kbdatadeletelisteners"))});return e}}(),F=function(){return function(B,u,A){function n(a,d,c,b,g,k,e){this.stopPropogation=
function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=d;this.arguments=k;this.type=c;this.listener=e;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=b;this.oldValue=g}function q(a,d,c,b){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.type=a;this.key=d;this.event=c;this.args=b}function x(a,d){var c=
e[d];return function(d,b){var g=new n(this,h(c)?d:"",a,h(c)?this[d]:"",h(c)?this[d]:"",arguments),g=new q(a,h(c)?d:"",g,arguments),e;!0!==k(g)&&(h(c)?(void 0===c[g.key]&&(c[g.key]=[]),e=c[g.key],e.push(g.args[1])):v(c)&&(void 0===c["*"]&&(c["*"]=[]),e=g.args[1]&&"*"===g.args[1]?c["*"]:c,e.push(g.args[0])));return this}}function t(a,d){var c=e[d];return function(d,b){var g=new n(this,d,a,this[d],this[d],arguments),g=new q(a,d,g,arguments),e;if(!0!==k(g))if(h(c)){if(e=c[g.key])for(var l=0,m=e.length;l<
m;l++)if(e[l].toString()===g.args[1].toString()){e.splice(l,1);break}}else if(v(c))for(void 0===c["*"]&&(c["*"]=[]),e=g.args[1]&&"*"===g.args[1]?c["*"]:c,l=0,m=e.length;l<m;l++)if(e[l].toString()===g.args[0].toString()){e.splice(l,1);break}return this}}function h(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function v(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}function z(a,d,c){return{get:function(){return a[d]},set:function(c){a[d]=
c},enumerable:c.enumerable,configurable:c.configurable}}function b(a,d,c){return{value:a,writable:!!d,enumerable:!1,configurable:!!c}}function g(a,d){var c=a,b=a,g=function(a,d){b=c;c=a;d.listener="__kbupdatelisteners";d.type="update";r(d)};return{get:function(){return c},set:function(a,e){var k=new n(this,d,"set",a,c,arguments,"__kblisteners");e?g(a,k):!0!==r(k)&&(g(a,k),this.callSubscribers(d,c,b))},configurable:!0,enumerable:!0}}var e={},m={},p={add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],
addDataListener:[],removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},k=function(a){for(var d=0,c=p[a.type],b=c.length;d!==b&&(c[d](a),!a._stopPropogration);d++);return a._preventDefault},l=function(a,d){if(!d._stopPropogration&&a)for(var c=0,b=a.length;c!==b&&(a[c](d),!d._stopPropogration);c++);},r=function(a){var d=a.local[a.listener];h(d)?(l(d[a.key],a),"__kblisteners"===
a.listener?(l(d["*"],a),a.fromListener="__kblisteners",a.listener="__kbparentlisteners",l(a.local[a.listener][a.key],a),l(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(l(d["*"],a),a.fromListener="__kbupdatelisteners",a.listener="__kbparentupdatelisteners",l(a.local[a.listener][a.key],a),l(a.local[a.listener]["*"],a))):v(d)&&(l(d,a),l(d["*"],a));return a._preventDefault};Object.defineProperties(e,{__kbname:b(B||"",!0,!0),__kbref:b(u?u.__kbref||u:e,!0,!0),__kbscopeString:b(A||"",
!0,!0),__kbImmediateParent:b(u||null,!0,!0),add:b(function(a,d){var c=new n(this,a,"add",d,void 0,arguments,"__kbdatacreatelisteners"),b=new q("add",a,c,arguments);!0!==k(b)&&(void 0===this[b.key]?!0!==r(c)&&(Object.defineProperty(this,b.key,g.call(this,b.args[1],b.key)),b.type="postadd",k(b)):console.error("Your attempting to add the property: ",b.key," that already exists on",this,"try using set or direct set instead"));return this}),addPointer:b(function(a,d,c){var b=new n(this,c||d,"add",a[d],
void 0,arguments,"__kbdatacreatelisteners"),g=new q("add",c||d,b,arguments);!0!==k(g)&&!0!==r(b)&&(b=Object.getOwnPropertyDescriptor(a,d),Object.defineProperty(this,g.key,z(a,d,b)),g.type="postadd",k(g));return this}),prototype:b(function(a,d){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(d,!0,!0)):console.error("Your attempting to add the your method with the prop: ",a," that already exists");return this}),set:b(function(a,d,c){var b=new n(this,a,"set",d,this[a],arguments,"__kblisteners"),
e=new q("set",a,b,arguments);void 0===this[a]?this.add(e.key,e.args[1]):!0!==k(e)&&(b.key=e.key,b.value=e.args[1],!0!==r(b)&&(void 0===Object.getOwnPropertyDescriptor(this,e.key).value?Object.getOwnPropertyDescriptor(this,e.key).set.call(this,e.args[1],c):Object.defineProperty(this,e.key,g.call(this,e.args[1],e.key)),e.type="postset",k(e)));return this}),remove:b(function(a){var d=new n(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),c=new q("remove",a,d,arguments);if(!0!==k(c)){if(void 0===
this[c.key])return console.error("Your attempting to remove the property: ",c.key," that does not exist on ",this),this;!0!==r(d)&&(Object.defineProperty(this,c.key,{value:null,writable:!0,enumerable:!0,configurable:!0}),c.type="postremove",k(c))}return this}),stringify:b(function(){var a=[];return JSON.stringify(this,function(d,c){if(v(c)||h(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,d,c){if(void 0!==m[a]){c=0;for(var b=m[a].length;c<b;c++)m[a][c](d)}return this}),
subscribe:b(function(a,d){void 0===m[a]&&(m[a]=[]);m[a].push(d);return this}),unsubscribe:b(function(a,d){if(void 0!==m[a]){var c=0,b=m[a].length;a:for(;c<b;c++)if(m[a][c].toString()===d.toString()){m[a].splice(c,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,d){-1!==Object.keys(p).indexOf(a)?p[a].push(d):console.error("There is no action listener by the name: ",
a);return this}),removeActionListener:b(function(a,d){if(-1!==Object.keys(p).indexOf(a))for(var c=0,b=p[a],g=b.length;c!==g;c++){if(b[c].toString()===d.toString()){b.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this}),onadd:b(function(){},!0),onremove:b(function(){},!0),onset:b(function(){},!0),onupdate:b(function(){},!0)});Object.defineProperties(e,{addDataListener:b(x("addDataListener","__kblisteners")),removeDataListener:b(t("removeDataListener","__kblisteners")),
addDataUpdateListener:b(x("addDataUpdateListener","__kbupdatelisteners")),removeDataUpdateListener:b(t("removeDataUpdateListener","__kbupdatelisteners")),addDataCreateListener:b(x("addDataCreateListener","__kbdatacreatelisteners")),removeDataCreateListener:b(t("removeDataCreateListener","__kbdatacreatelisteners")),addDataRemoveListener:b(x("addDataRemoveListener","__kbdatadeletelisteners")),removeDataRemoveListener:b(t("removeDataRemoveListener","__kbdatadeletelisteners"))});return e}}(),C=function(B,
u){return function(A){function n(b){return"[object Array]"===Object.prototype.toString.call(b)}function q(b){return"[object Object]"===Object.prototype.toString.call(b)}function x(b){return b.split(".").filter(function(b){return 0!==b.length})}function t(b,e){function h(b){e.splice(0,1);return 0===e.length?b:h(b[e[0]])}return(e=x(e))&&1!==e.length?h(b[e[0]]):e&&e.length?b[e[0]]:b}function h(b){if(1===b.key.split(".").length&&"*"!==b.key)return b.preventDefault(),!1;if("*"!==b.key)t(b.event.local,
b.key)[b.type](b.key,b.args[1]);else b.event.local.addChildListener("*",b.args[1])}function v(b){return function(e,h){function p(e,l,h){var a=Object.keys(e).filter(function(a){return q(e[a])||n(e[a])});void 0===e[b][l]&&(e[b][l]=[]);e[b][l].push(h);for(var d=0;d<a;d++)p(a[d],l,h)}p(this,e,h);return this}}function z(b){return function(e,h){function p(e,l,h){var a=Object.keys(e).filter(function(a){return q(e[a])||n(e[a])}),d=0,c=e[b][l].length;a:for(;d<c;d++)if(e[b][l][d].toString()===h.toString()){e[b][l].splice(d,
1);break a}for(d=0;d<a;d++)p(a[d],l,h)}p(this,e,h);return this}}var b={name:A};_data=u().addPointer(b,"name","__kbname");_data.prototype("updateName",function(g){"string"===typeof g&&(b.name=g);return this});_data.prototype("isArray",n).prototype("isObject",q).prototype("isObservable",function(b,e){return void 0===Object.getOwnPropertyDescriptor(b,e).vaue}).prototype("updateName",function(g){"string"===typeof g&&(b.name=g);return this}).prototype("getScopeByScopeString",t).prototype("addChildDataListener",
v("__kbparentlisteners")).prototype("removeChildDataListener",z("__kbparentlisteners")).prototype("addChildDataUpdateListener",v("__kbparentupdatelisteners")).prototype("removeChildDataUpdateListener",z("__kbparentupdatelisteners")).addActionListener("addDataListener",h).addActionListener("addDataUpdateListener",h).addActionListener("addDataCreateListener",h).addActionListener("addDataDeleteListener",h).addActionListener("removeDataListener",h).addActionListener("removeDataUpdateListener",h).addActionListener("removeDataCreateListener",
h).addActionListener("removeDataDeleteListener",h);return _data}}(E,F);window.define&&window.require?define([],function(){return C}):window.module&&(module.exports=C);return C}();
