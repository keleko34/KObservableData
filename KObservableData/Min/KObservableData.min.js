var KObservableData=function(){var E=function(){return function(A,u,B){function n(a,d,c,e,f,b){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=d;this.arguments=b;this.type=c;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=e;this.oldValue=f}function p(a,d,c,e){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=
!0};this.type=a;this.key=d;this.event=c;this.args=e}function v(a,d){var c=q[d];return function(d,f){var b=new n(this,r(c)?d:"",a,r(c)?this[d]:"",r(c)?this[d]:"",arguments),b=new p(a,r(c)?d:"",b,arguments),l;!0!==h(b)&&(r(c)?(void 0===c[b.key]&&(c[b.key]=[]),l=c[b.key],l.push(b.args[1])):t(c)&&(void 0===c["*"]&&(c["*"]=[]),l=b.args[1]&&"*"===b.args[1]?c["*"]:c,l.push(b.args[0])));return this}}function x(a,d){var c=q[d];return function(d,f){var b=new n(this,d,a,this[d],this[d],arguments),b=new p(a,
d,b,arguments),l;if(!0!==h(b))if(r(c)){if(l=c[b.key])for(var k=0,g=l.length;k<g;k++)if(l[k].toString()===b.args[1].toString()){l.splice(k,1);break}}else if(t(c))for(void 0===c["*"]&&(c["*"]=[]),l=b.args[1]&&"*"===b.args[1]?c["*"]:c,k=0,g=l.length;k<g;k++)if(l[k].toString()===b.args[0].toString()){l.splice(k,1);break}return this}}function r(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function t(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}
function z(a,d,c){return{get:function(){return a[d]},set:function(c){a[d]=c},enumerable:c.enumerable,configurable:c.configurable}}function b(a,d,c){return{value:a,writable:!!d,enumerable:!1,configurable:!!c}}function y(a,d){var c=a,e=a,b=function(a,d){e=c;c=a;d.listener="__kbupdatelisteners";d.type="update";f(d)};return{get:function(){return c},set:function(a,l){var k=new n(this,d,"set",a,c,arguments,"__kblisteners");l?b(a,k):!0!==f(k)&&(b(a,k),this.callSubscribers(d,c,e))},configurable:!0,enumerable:!0}}
var q=[],g={},w={splice:[],postsplice:[],push:[],postpush:[],pop:[],postpop:[],shift:[],postshift:[],unshift:[],postunshift:[],fill:[],postfill:[],reverse:[],postreverse:[],sort:[],postsort:[],add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],addDataListener:[],removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},h=function(a){for(var d=0,c=w[a.type],e=c.length;d!==
e&&(c[d](a),!a._stopPropogration);d++);return a._preventDefault},m=function(a,d){if(!d._stopPropogration&&a)for(var c=0,e=a.length;c!==e&&(a[c](d),!d._stopPropogration);c++);},f=function(a){var d=a.local[a.listener];r(d)?(m(d[a.key],a),"__kblisteners"===a.listener?(m(d["*"],a),a.fromListener="__kblisteners",a.listener="__kbparentlisteners",m(a.local[a.listener][a.key],a),m(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(m(d["*"],a),a.fromListener="__kbupdatelisteners",a.listener=
"__kbparentupdatelisteners",m(a.local[a.listener][a.key],a),m(a.local[a.listener]["*"],a))):t(d)&&(m(d,a),m(d["*"],a));return a._preventDefault};Object.defineProperties(q,{__kbname:b(A||"",!0,!0),__kbref:b(u?u.__kbref||u:q,!0,!0),__kbscopeString:b(B||"",!0,!0),__kbImmediateParent:b(u||null,!0,!0),splice:b(function(a,d,c){var e=new n(this,a,"splice",this[a],void 0,arguments,"__kbdatadeletelisteners"),b=new p("splice",a,e,arguments);if(!0!==h(b)){var C=[],l=t(b.args[2]),k=void 0!==b.args[2]?l?b.args[2].length:
1:0,g=0;if(0!==d&&void 0!==this[b.key-1+b.args[1]]){for(var m=0,r=b.args[1];m<r;m++)if(g=b.key+m,e.key=g,e.type="remove",e.value=this[g],!0!==f(e)){C.push(this[g-C.length]);for(var q=b.key,u=this.length-1;q<u;q++)this[q]=this[q+1]}else--b.args[1];this.length-=b.args[1]}if(0!==k)for(l||(b.args[2]=[b.args[2]]),m=0,r=k;m<r;m++)if(g=b.key+m,e.key=g,e.type="add",e.listener="__kbdatacreatelisteners",e.value=b.args[2][m],!0!==f(e)){q=this.length;for(u=g;q>u;q--)void 0===this[q]?Object.defineProperty(this,
q,y.call(this,this[q-1],q)):this[q]=this[q-1];this[g]=b.args[2][m]}b.type="postsplice";h(b)}return C}),push:b(function(a){var d=new n(this,this.length,"push",a,void 0,arguments,"__kbdatacreatelisteners"),c=new p("push",this.length,d,arguments);!0!==h(c)&&(d.type="add",d.value=c.args[0],d.key=c.key,!0!==f(d)&&(Object.defineProperty(this,c.key,y.call(this,c.args[0],c.key)),c.type="postpush",h(c)));return this.length}),pop:b(function(){var a=new n(this,this.length-1,"pop",this[this.length-1],void 0,
arguments,"__kbdatadeletelisteners"),d=new p("pop",this.length-1,a,arguments);if(!0!==h(d)){var c=this[this.length-1];a.type="remove";if(!0!==f(a))return--this.length,d.type="postpop",h(d),c}return null}),shift:b(function(){var a=new n(this,0,"shift",this[0],void 0,arguments,"__kbdatadeletelisteners"),d=new p("shift",0,a,arguments);if(!0!==h(d)){var c=this[d.key];a.type="remove";a.key=d.key;if(!0!==f(a)){for(var a=d.key,e=this.length-1;a<e;a++)this[a]=this[a+1];--this.length;d.type="postshift";h(d);
return c}}return null}),unshift:b(function(){var a=new n(this,0,"unshift",this[0],void 0,arguments,"__kbdatacreatelisteners"),d=new p("unshift",0,a,arguments);if(!0!==h(d)){for(var c=Array.prototype.slice.call(d.args),e=0,b=c.length;e<b;e++)a.key=e,a.type="add",a.value=c[e],!0===f(a)&&c.splice(e,1);if(0!==c.length){e=this.length-1+c.length;for(b=c.length;-1!==e;e--)e<b?this[e]=c[e]:void 0!==Object.getOwnPropertyDescriptor(this,e).value?Object.defineProperty(this,e,y.call(this,this[e-c.length],e)):
this[e]=this[e-c.length];d.type="postunshift";h(d)}}return this.length}),fill:b(function(a,d,c){var e=void 0!==d?Math.max(0,d):0,b=new n(this,e,"fill",a,this[e],arguments,"__kbdatalisteners"),e=new p("fill",e,b,arguments);if(!0!==h(e)){for(b=e.key;b<e.args[2];b++)this[b]=e.args[0];e.type="postfill";h(e)}return this}),reverse:b(function(){var a=new n(this,0,"reverse",value,this[_start],arguments,"__kbdatalisteners"),a=new p("reverse",0,a,arguments);if(!0!==h(a)){for(var d=this.slice().reverse(),c=
0,e=this.length;c<e;c++)this[c]=d[c];a.type="postreverse";h(a)}return this}),sort:b(function(){var a=new n(this,0,"sort",value,this[_start],arguments,"__kbdatalisteners"),a=new p("sort",0,a,arguments);if(!0!==h(a)){for(var d=this.slice(),d=d.sort.apply(d,arguments),c=0,e=this.length;c<e;c++)this[c]=d[c];a.type="postsort";h(a)}return this}),add:b(function(a,d){var c=new n(this,a,"add",d,void 0,arguments,"__kbdatacreatelisteners"),e=new p("add",a,c,arguments);void 0===a?this.push(d):!0!==h(e)&&(void 0===
this[e.key]?!0!==f(c)&&(Object.defineProperty(this,e.key,y.call(this,e.args[1],e.key)),e.type="postadd",h(e)):console.error("Your attempting to add the index: ",e.key," that already exists on",this,"try using set or direct set instead"));return this}),prototype:b(function(a,d){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(d,!0,!0)):console.error("Your attempting to add your prototype with the prop: ",a," that already exists");return this}),addPointer:b(function(a,d,c){var e=new n(this,
c||d,"add",a[d],void 0,arguments,"__kbdatacreatelisteners"),b=new p("add",c||d,e,arguments);!0!==h(b)&&!0!==f(e)&&(e=Object.getOwnPropertyDescriptor(a,d),Object.defineProperty(this,b.key,z(a,d,e)),b.type="postadd",h(b));return this}),set:b(function(a,d,c){var e=new n(this,a,"set",d,this[a],arguments,"__kblisteners"),b=new p("set",a,e,arguments);void 0===this[a]?this.add(a,d):!0!==h(b)&&(e.key=b.key,e.value=b.args[1],!0!==f(e)&&(void 0===Object.getOwnPropertyDescriptor(this,b.key).value?Object.getOwnPropertyDescriptor(this,
b.key).set(b.args[1],c):Object.defineProperty(this,b.key,y.call(this,b.args[1],b.key)),b.type="postset",h(b)));return this}),remove:b(function(a,d){var c=new n(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),c=new p("remove",a,c,arguments);if(!0!==h(c)){if(void 0===this[c.key])return console.error("Your attempting to remove the index: ",c.key," that does not exist on ",this),this;this.splice(c.key,c.args[1])}return this}),stringify:b(function(){var a=[];return JSON.stringify(this,
function(d,c){if(t(c)||r(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,d,c){if(void 0!==g[a]){c=0;for(var b=g[a].length;c<b;c++)g[a][c](d)}return this}),subscribe:b(function(a,d){void 0===g[a]&&(g[a]=[]);g[a].push(d);return this}),unsubscribe:b(function(a,d){if(void 0!==g[a]){var c=0,b=g[a].length;a:for(;c<b;c++)if(g[a][c].toString()===d.toString()){g[a].splice(c,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),
__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,d){-1!==Object.keys(w).indexOf(a)?w[a].push(d):console.error("There is no action listener by the name: ",a);return this}),removeActionListener:b(function(a,d){if(-1!==Object.keys(w).indexOf(a))for(var c=0,b=w[a],f=b.length;c!==f;c++){if(b[c].toString()===d.toString()){b.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this})});Object.defineProperties(q,
{addDataListener:b(v("__kblisteners")),removeDataListener:b(x("__kblisteners")),addDataUpdateListener:b(v("__kbupdatelisteners")),removeDataUpdateListener:b(x("__kbupdatelisteners")),addDataCreateListener:b(v("__kbdatacreatelisteners")),removeDataCreateListener:b(x("__kbdatacreatelisteners")),addDataRemoveListener:b(v("__kbdatadeletelisteners")),removeDataRemoveListener:b(x("__kbdatadeletelisteners"))});return q}}(),F=function(){return function(A,u,B){function n(a,d,c,b,f,h,l){this.stopPropogation=
function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=d;this.arguments=h;this.type=c;this.listener=l;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=b;this.oldValue=f}function p(a,d,c,b){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.type=a;this.key=d;this.event=c;this.args=b}function v(a,d){var c=
q[d];return function(d,b){var f=new n(this,r(c)?d:"",a,r(c)?this[d]:"",r(c)?this[d]:"",arguments),f=new p(a,r(c)?d:"",f,arguments),l;!0!==h(f)&&(r(c)?(void 0===c[f.key]&&(c[f.key]=[]),l=c[f.key],l.push(f.args[1])):t(c)&&(void 0===c["*"]&&(c["*"]=[]),l=f.args[1]&&"*"===f.args[1]?c["*"]:c,l.push(f.args[0])));return this}}function x(a,d){var c=q[d];return function(d,b){var f=new n(this,d,a,this[d],this[d],arguments),f=new p(a,d,f,arguments),l;if(!0!==h(f))if(r(c)){if(l=c[f.key])for(var k=0,g=l.length;k<
g;k++)if(l[k].toString()===f.args[1].toString()){l.splice(k,1);break}}else if(t(c))for(void 0===c["*"]&&(c["*"]=[]),l=f.args[1]&&"*"===f.args[1]?c["*"]:c,k=0,g=l.length;k<g;k++)if(l[k].toString()===f.args[0].toString()){l.splice(k,1);break}return this}}function r(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function t(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}function z(a,d,c){return{get:function(){return a[d]},set:function(c){a[d]=
c},enumerable:c.enumerable,configurable:c.configurable}}function b(a,d,c){return{value:a,writable:!!d,enumerable:!1,configurable:!!c}}function y(a,d){var c=a,b=a,h=function(a,d){b=c;c=a;d.listener="__kbupdatelisteners";d.type="update";f(d)};return{get:function(){return c},set:function(a,l){var k=new n(this,d,"set",a,c,arguments,"__kblisteners");l?h(a,k):!0!==f(k)&&(h(a,k),this.callSubscribers(d,c,b))},configurable:!0,enumerable:!0}}var q={},g={},w={add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],
addDataListener:[],removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},h=function(a){for(var d=0,c=w[a.type],b=c.length;d!==b&&(c[d](a),!a._stopPropogration);d++);return a._preventDefault},m=function(a,d){if(!d._stopPropogration&&a)for(var c=0,b=a.length;c!==b&&(a[c](d),!d._stopPropogration);c++);},f=function(a){var d=a.local[a.listener];r(d)?(m(d[a.key],a),"__kblisteners"===
a.listener?(m(d["*"],a),a.fromListener="__kblisteners",a.listener="__kbparentlisteners",m(a.local[a.listener][a.key],a),m(a.local[a.listener]["*"],a)):"__kbupdatelisteners"===a.listener&&(m(d["*"],a),a.fromListener="__kbupdatelisteners",a.listener="__kbparentupdatelisteners",m(a.local[a.listener][a.key],a),m(a.local[a.listener]["*"],a))):t(d)&&(m(d,a),m(d["*"],a));return a._preventDefault};Object.defineProperties(q,{__kbname:b(A||"",!0,!0),__kbref:b(u?u.__kbref||u:q,!0,!0),__kbscopeString:b(B||"",
!0,!0),__kbImmediateParent:b(u||null,!0,!0),add:b(function(a,d){var c=new n(this,a,"add",d,void 0,arguments,"__kbdatacreatelisteners"),b=new p("add",a,c,arguments);!0!==h(b)&&(void 0===this[b.key]?!0!==f(c)&&(Object.defineProperty(this,b.key,y.call(this,b.args[1],b.key)),b.type="postadd",h(b)):console.error("Your attempting to add the property: ",b.key," that already exists on",this,"try using set or direct set instead"));return this}),addPointer:b(function(a,d,c){var b=new n(this,c||d,"add",a[d],
void 0,arguments,"__kbdatacreatelisteners"),g=new p("add",c||d,b,arguments);!0!==h(g)&&!0!==f(b)&&(b=Object.getOwnPropertyDescriptor(a,d),Object.defineProperty(this,g.key,z(a,d,b)),g.type="postadd",h(g));return this}),prototype:b(function(a,d){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(d,!0,!0)):console.error("Your attempting to add the your method with the prop: ",a," that already exists");return this}),set:b(function(a,d,c){var b=new n(this,a,"set",d,this[a],arguments,"__kblisteners"),
g=new p("set",a,b,arguments);void 0===this[a]?this.add(g.key,g.args[1]):!0!==h(g)&&(b.key=g.key,b.value=g.args[1],!0!==f(b)&&(void 0===Object.getOwnPropertyDescriptor(this,g.key).value?Object.getOwnPropertyDescriptor(this,g.key).set.call(this,g.args[1],c):Object.defineProperty(this,g.key,y.call(this,g.args[1],g.key)),g.type="postset",h(g)));return this}),remove:b(function(a){var d=new n(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),c=new p("remove",a,d,arguments);if(!0!==h(c)){if(void 0===
this[c.key])return console.error("Your attempting to remove the property: ",c.key," that does not exist on ",this),this;!0!==f(d)&&(Object.defineProperty(this,c.key,{value:null,writable:!0,enumerable:!0,configurable:!0}),c.type="postremove",h(c))}return this}),stringify:b(function(){var a=[];return JSON.stringify(this,function(d,c){if(t(c)||r(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,d,c){if(void 0!==g[a]){c=0;for(var b=g[a].length;c<b;c++)g[a][c](d)}return this}),
subscribe:b(function(a,b){void 0===g[a]&&(g[a]=[]);g[a].push(b);return this}),unsubscribe:b(function(a,b){if(void 0!==g[a]){var c=0,f=g[a].length;a:for(;c<f;c++)if(g[a][c].toString()===b.toString()){g[a].splice(c,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,b){-1!==Object.keys(w).indexOf(a)?w[a].push(b):console.error("There is no action listener by the name: ",
a);return this}),removeActionListener:b(function(a,b){if(-1!==Object.keys(w).indexOf(a))for(var c=0,f=w[a],g=f.length;c!==g;c++){if(f[c].toString()===b.toString()){f.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this}),onadd:b(function(){},!0),onremove:b(function(){},!0),onset:b(function(){},!0),onupdate:b(function(){},!0)});Object.defineProperties(q,{addDataListener:b(v("addDataListener","__kblisteners")),removeDataListener:b(x("removeDataListener","__kblisteners")),
addDataUpdateListener:b(v("addDataUpdateListener","__kbupdatelisteners")),removeDataUpdateListener:b(x("removeDataUpdateListener","__kbupdatelisteners")),addDataCreateListener:b(v("addDataCreateListener","__kbdatacreatelisteners")),removeDataCreateListener:b(x("removeDataCreateListener","__kbdatacreatelisteners")),addDataRemoveListener:b(v("addDataRemoveListener","__kbdatadeletelisteners")),removeDataRemoveListener:b(x("removeDataRemoveListener","__kbdatadeletelisteners"))});return q}}(),D=function(A,
u){return function(B){function n(b){return"[object Array]"===Object.prototype.toString.call(b)}function p(b){return"[object Object]"===Object.prototype.toString.call(b)}function v(b,a){return a?void 0===Object.getOwnPropertyDescriptor(b,a).value:void 0!==b.__kbname}function x(b){return b.split(".").filter(function(a){return 0!==a.length})}function r(b,a){function d(b){a.splice(0,1);return 0===a.length?b:d(b[a[0]])}return(a=x(a))&&1!==a.length?d(b[a[0]]):a&&a.length?b[a[0]]:b}function t(b){if(1===
b.key.split(".").length&&"*"!==b.key)return b.preventDefault(),!1;if("*"!==b.key)r(b.event.local,b.key)[b.type](b.key,b.args[1]);else b.event.listener.indexOf("update")?b.event.local.addChildDataUpdateListener("*",b.args[1]):b.event.local.addChildDataListener("*",b.args[1])}function z(f){void 0===f.parseData&&f.prototype("parseData",h);void 0===f.isArray&&f.prototype("isArray",n);void 0===f.isObject&&f.prototype("isObject",p);void 0===f.isObservable&&f.prototype("isObservable",v);void 0===f.updateName&&
f.prototype("updateName",q);void 0===f.getScopeByScopeString&&f.prototype("getScopeByScopeString",r);void 0===f.addChildDataListener&&f.prototype("addChildDataListener",b("__kbparentlisteners"));void 0===f.removeChildDataListener&&f.prototype("removeChildDataListener",y("__kbparentlisteners"));void 0===f.addChildDataUpdateListener&&f.prototype("addChildDataUpdateListener",b("__kbparentupdatelisteners"));void 0===f.removeChildDataUpdateListener&&f.prototype("removeChildDataUpdateListener",y("__kbparentupdatelisteners"));
return f.addActionListener("add",g).addActionListener("set",w).addActionListener("addDataListener",t).addActionListener("addDataUpdateListener",t).addActionListener("addDataCreateListener",t).addActionListener("addDataRemoveListener",t).addActionListener("removeDataListener",t).addActionListener("removeDataUpdateListener",t).addActionListener("removeDataCreateListener",t).addActionListener("removeDataRemoveListener",t)}function b(b){return function(a,d){function c(a,d,g){var h=Object.keys(a).filter(function(b){return p(a[b])||
n(a[b])});void 0===a[b][d]&&(a[b][d]=[]);a[b][d].push(g);for(var k=0;k<h;k++)c(h[k],d,g)}c(this,a,d);return this}}function y(b){return function(a,d){function c(a,d,g){var h=Object.keys(a).filter(function(b){return p(a[b])||n(a[b])}),k=0,m=a[b][d].length;a:for(;k<m;k++)if(a[b][d][k].toString()===g.toString()){a[b][d].splice(k,1);break a}for(k=0;k<h;k++)c(h[k],d,g)}c(this,a,d);return this}}function q(b){"string"===typeof b&&(m.name=b);return this}function g(b){if((p(b.args[1])||n(b.args[1]))&&!v(b.args[1])){b.preventDefault();
var a=b.event.local.__kbscopeString+(0!==b.event.local.__kbscopeString.length?".":"")+b.key,a=(p(b.args[1])?u:A)(b.event.local.__kbname,b.event.local,a);b.event.local.add(b.key,a);z(b.event.local[b.key]).parseData(b.args[1])}}function w(b){if((p(b.args[1])||n(b.args[1]))&&!v(b.args[1])){b.preventDefault();var a=b.event.local.__kbscopeString+(0!==b.event.local.__kbscopeString.length?".":"")+b.key,a=(p(b.args[1])?u:A)(b.event.local.__kbname,b.event.local,a);b.event.local.set(b.key,a);z(b.event.local[b.key]).parseData(b.args[1])}}
function h(b){for(var a=0,d=Object.keys(b),c=d.length;a<c;a++)this.set(d[a],b[d[a]]);return this}var m={name:B};_data=u(m.name,void 0,"").addPointer(m,"name","__kbname");z(_data);return _data}}(E,F);window.define&&window.require?define([],function(){return D}):window.module&&(module.exports=D);return D}();
