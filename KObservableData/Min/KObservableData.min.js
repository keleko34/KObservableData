var KObservableData=function(){var C=function(){return function(z,t,y){function l(a,d,c,e,B,b){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=d;this.arguments=b;this.type=c;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=a.___kbImmediateParent;this.value=e;this.oldValue=B}function n(a,d,c,e){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=
!0};this.type=a;this.key=d;this.event=c;this.args=e}function u(a,d){var c=f[d];return function(e,d){var b=new l(this,e,a,this[e],this[e],arguments),b=new n(a,e,b,arguments),g;!0!==k(b)&&(p(c)&&void 0===c[b.key]&&(c[b.key]=[]),g=p(c)?c[b.key]:c,g.push(b.args[1]));return this}}function q(a,d){var c=f[d];return function(e,d){var b=new l(this,e,a,this[e],this[e],arguments),b=new n(a,e,b,arguments),g;if(!0!==k(b)){void 0!==b.args[1]&&(g=p(c)?c[b.key]:c);for(var f=0,r=g.length;f<r;f++)if(g[f].toString()===
b.args[1].toString()){g.splice(f,1);break}}return this}}function p(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function w(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}function x(a,d,c){return{get:function(){return a[d]},set:function(c){a[d]=c},enumerable:c.enumerable,configurable:c.configurable}}function b(a,d,c){return{value:a,writable:!!d,enumerable:!1,configurable:!!c}}function g(a,d){var c=a,e=a,b=function(a,d){e=c;c=a;d.listener=
"__kbupdatelisteners";d.type="update";r(d)};return{get:function(){return c},set:function(a,k){var g=new l(this,d,"set",a,c,arguments,"__kblisteners");k?b(a,g):!0!==r(g)&&(b(a,g),this.callSubscribers(d,c,e))},configurable:!0,enumerable:!0}}var f=[],h={},m={splice:[],postsplice:[],push:[],postpush:[],pop:[],postpop:[],shift:[],postshift:[],unshift:[],postunshift:[],fill:[],postfill:[],reverse:[],postreverse:[],sort:[],postsort:[],add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],addDataListener:[],
removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},k=function(a){for(var d=0,c=m[a.type],e=c.length;d!==e&&(c[d](a),!a._stopPropogration);d++);return a._preventDefault},r=function(a){var d=a.local[a.listener];p(d)&&(d=d[a.key]);if(w(d))for(var c=0,e=d.length;c!==e&&(d[c](a),!a._stopPropogration);c++);return a._preventDefault};Object.defineProperties(f,{__kbname:b(z||"",
!0,!0),__kbref:b(t?t.__kbref||t:f,!0,!0),__kbscopeString:b(y||"",!0,!0),__kbImmediateParent:b(t||null,!0,!0),splice:b(function(a,d,c){var e=new l(this,a,"splice",this[a],void 0,arguments,"__kbdatadeletelisteners"),b=new n("splice",a,e,arguments);if(!0!==k(b)){var f=[],h=w(b.args[2]),p=void 0!==b.args[2]?h?b.args[2].length:1:0,m=0;if(0!==d&&void 0!==this[b.key-1+b.args[1]]){for(var q=0,t=b.args[1];q<t;q++)if(m=b.key+q,e.key=m,e.type="remove",e.value=this[m],!0!==r(e)){f.push(this[m-f.length]);for(var v=
b.key,u=this.length-1;v<u;v++)this[v]=this[v+1]}else--b.args[1];this.length-=b.args[1]}if(0!==p)for(h||(b.args[2]=[b.args[2]]),q=0,t=p;q<t;q++)if(m=b.key+q,e.key=m,e.type="add",e.listener="__kbdatacreatelisteners",e.value=b.args[2][q],!0!==r(e)){v=this.length;for(u=m;v>u;v--)void 0===this[v]?Object.defineProperty(this,v,g.call(this,this[v-1],v)):this[v]=this[v-1];this[m]=b.args[2][q]}b.type="postsplice";k(b)}return f}),push:b(function(a){var d=new l(this,this.length,"push",a,void 0,arguments,"__kbdatacreatelisteners"),
c=new n("push",this.length,d,arguments);!0!==k(c)&&(d.type="add",d.value=c.args[0],d.key=c.key,!0!==r(d)&&(Object.defineProperty(this,c.key,g.call(this,c.args[0],c.key)),c.type="postpush",k(c)));return this.length}),pop:b(function(){var a=new l(this,this.length-1,"pop",this[this.length-1],void 0,arguments,"__kbdatadeletelisteners"),d=new n("pop",this.length-1,a,arguments);if(!0!==k(d)){var c=this[this.length-1];a.type="remove";if(!0!==r(a))return--this.length,d.type="postpop",k(d),c}return null}),
shift:b(function(){var a=new l(this,0,"shift",this[0],void 0,arguments,"__kbdatadeletelisteners"),d=new n("shift",0,a,arguments);if(!0!==k(d)){var c=this[d.key];a.type="remove";a.key=d.key;if(!0!==r(a)){for(var a=d.key,e=this.length-1;a<e;a++)this[a]=this[a+1];--this.length;d.type="postshift";k(d);return c}}return null}),unshift:b(function(){var a=new l(this,0,"unshift",this[0],void 0,arguments,"__kbdatacreatelisteners"),d=new n("unshift",0,a,arguments);if(!0!==k(d)){for(var c=Array.prototype.slice.call(d.args),
e=0,b=c.length;e<b;e++)a.key=e,a.type="add",a.value=c[e],!0===r(a)&&c.splice(e,1);if(0!==c.length){e=this.length-1+c.length;for(b=c.length;-1!==e;e--)e<b?this[e]=c[e]:void 0!==Object.getOwnPropertyDescriptor(this,e).value?Object.defineProperty(this,e,g.call(this,this[e-c.length],e)):this[e]=this[e-c.length];d.type="postunshift";k(d)}}return this.length}),fill:b(function(a,d,c){var e=void 0!==d?Math.max(0,d):0,b=new l(this,e,"fill",a,this[e],arguments,"__kbdatalisteners"),e=new n("fill",e,b,arguments);
if(!0!==k(e)){for(b=e.key;b<e.args[2];b++)this[b]=e.args[0];e.type="postfill";k(e)}return this}),reverse:b(function(){var a=new l(this,0,"reverse",value,this[_start],arguments,"__kbdatalisteners"),a=new n("reverse",0,a,arguments);if(!0!==k(a)){for(var d=this.slice().reverse(),c=0,e=this.length;c<e;c++)this[c]=d[c];a.type="postreverse";k(a)}return this}),sort:b(function(){var a=new l(this,0,"sort",value,this[_start],arguments,"__kbdatalisteners"),a=new n("sort",0,a,arguments);if(!0!==k(a)){for(var d=
this.slice(),d=d.sort.apply(d,arguments),c=0,e=this.length;c<e;c++)this[c]=d[c];a.type="postsort";k(a)}return this}),add:b(function(a,d){var c=new l(this,d,"add",a,void 0,arguments,"__kbdatacreatelisteners"),e=new n("add",d,c,arguments);void 0===d?this.push(a):!0!==k(e)&&(void 0===this[e.key]?!0!==r(c)&&(Object.defineProperty(this,e.key,g.call(this,e.args[0],e.key)),e.type="postadd",k(e)):console.error("Your attempting to add the index: ",e.key," that already exists on",this,"try using set or direct set instead"));
return this}),prototype:b(function(a,d){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(d,!0,!0)):console.error("Your attempting to add your prototype with the prop: ",a," that already exists");return this}),addPointer:b(function(a,d,c){var e=new l(this,c||d,"add",a[d],void 0,arguments,"__kbdatacreatelisteners"),b=new n("add",c||d,e,arguments);!0!==k(b)&&!0!==r(e)&&(e=Object.getOwnPropertyDescriptor(a,d),Object.defineProperty(this,b.key,x(a,d,e)),b.type="postadd",k(b));return this}),set:b(function(a,
d,c){var e=new l(this,a,"set",d,this[a],arguments,"__kblisteners"),b=new n("set",a,e,arguments);void 0===this[a]?this.add(d,a):!0!==k(b)&&(e.key=b.key,e.value=b.args[1],!0!==r(e)&&(void 0===Object.getOwnPropertyDescriptor(this,b.key).value?Object.getOwnPropertyDescriptor(this,b.key).set(b.args[1],c):Object.defineProperty(this,b.key,g.call(this,b.args[1],b.key)),b.type="postset",k(b)));return this}),remove:b(function(a,d){var c=new l(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),
c=new n("remove",a,c,arguments);if(!0!==k(c)){if(void 0===this[c.key])return console.error("Your attempting to remove the index: ",c.key," that does not exist on ",this),this;this.splice(c.key,c.args[1])}return this}),stringify:b(function(){var a=[];return JSON.stringify(this,function(d,c){if(w(c)||p(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,d,c){if(void 0!==h[a]){c=0;for(var e=h[a].length;c<e;c++)h[a][c](d)}return this}),subscribe:b(function(a,d){void 0===
h[a]&&(h[a]=[]);h[a].push(d);return this}),unsubscribe:b(function(a,d){if(void 0!==h[a]){var c=0,e=h[a].length;a:for(;c<e;c++)if(h[a][c].toString()===d.toString()){h[a].splice(c,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,d){-1!==Object.keys(m).indexOf(a)?m[a].push(d):console.error("There is no action listener by the name: ",
a);return this}),removeActionListener:b(function(a,d){if(-1!==Object.keys(m).indexOf(a))for(var c=0,e=m[a],b=e.length;c!==b;c++){if(e[c].toString()===d.toString()){e.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this})});Object.defineProperties(f,{addDataListener:b(u("__kblisteners")),removeDataListener:b(q("__kblisteners")),addDataUpdateListener:b(u("__kbupdatelisteners")),removeDataUpdateListener:b(q("__kbupdatelisteners")),addDataCreateListener:b(u("__kbdatacreatelisteners")),
removeDataCreateListener:b(q("__kbdatacreatelisteners")),addDataRemoveListener:b(u("__kbdatadeletelisteners")),removeDataRemoveListener:b(q("__kbdatadeletelisteners"))});return f}}(),D=function(){return function(z,t,y){function l(a,d,c,e,b,g,k){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.local=a;this.key=d;this.arguments=g;this.type=c;this.listener=k;this.name=a.__kbname;this.root=a.__kbref;this.scope=a.__kbscopeString;this.parent=
a.___kbImmediateParent;this.value=e;this.oldValue=b}function n(a,d,c,e){this.stopPropogation=function(){this._stopPropogration=!0};this.preventDefault=function(){this._preventDefault=!0};this.type=a;this.key=d;this.event=c;this.args=e}function u(a,d){var c=f[d];return function(d,b){var g=new l(this,d,a,this[d],this[d],arguments),g=new n(a,d,g,arguments),f;!0!==k(g)&&(p(c)&&void 0===c[g.key]&&(c[g.key]=[]),f=p(c)?c[g.key]:c,f.push(g.args[1]));return this}}function q(a,d){var c=f[d];return function(d,
b){var g=new l(this,d,a,this[d],this[d],arguments),g=new n(a,d,g,arguments),f;if(!0!==k(g)){void 0!==g.args[1]&&(f=p(c)?c[g.key]:c);for(var h=0,r=f.length;h<r;h++)if(f[h].toString()===g.args[1].toString()){f.splice(h,1);break}}return this}}function p(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Object.toString()}function w(a){return"object"===typeof a&&!!a&&a.constructor.toString()===Array.toString()}function x(a,d,c){return{get:function(){return a[d]},set:function(c){a[d]=c},enumerable:c.enumerable,
configurable:c.configurable}}function b(a,d,c){return{value:a,writable:!!d,enumerable:!1,configurable:!!c}}function g(a,d){var c=a,b=a,g=function(a,d){b=c;c=a;d.listener="__kbupdatelisteners";d.type="update";r(d)};return{get:function(){return c},set:function(a,k){var f=new l(this,d,"set",a,c,arguments,"__kblisteners");k?g(a,f):!0!==r(f)&&(g(a,f),this.callSubscribers(d,c,b))},configurable:!0,enumerable:!0}}var f={},h={},m={add:[],postadd:[],set:[],postset:[],remove:[],postremove:[],addDataListener:[],
removeDataListener:[],addDataUpdateListener:[],removeDataUpdateListener:[],addDataCreateListener:[],removeDataCreateListener:[],addDataRemoveListener:[],removeDataRemoveListener:[]},k=function(a){for(var d=0,c=m[a.type],b=c.length;d!==b&&(c[d](a),!a._stopPropogration);d++);return a._preventDefault},r=function(a){var d=a.local[a.listener];p(d)&&(d=d[a.key]);if(w(d))for(var c=0,b=d.length;c!==b&&(d[c](a),!a._stopPropogration);c++);return a._preventDefault};Object.defineProperties(f,{__kbname:b(z||"",
!0,!0),__kbref:b(t?t.__kbref||t:f,!0,!0),__kbscopeString:b(y||"",!0,!0),__kbImmediateParent:b(t||null,!0,!0),add:b(function(a,d){var c=new l(this,a,"add",d,void 0,arguments,"__kbdatacreatelisteners"),b=new n("add",a,c,arguments);!0!==k(b)&&(void 0===this[b.key]?!0!==r(c)&&(Object.defineProperty(this,b.key,g.call(this,b.args[1],b.key)),b.type="postadd",k(b)):console.error("Your attempting to add the property: ",b.key," that already exists on",this,"try using set or direct set instead"));return this}),
addPointer:b(function(a,d,c){var b=new l(this,c||d,"add",a[d],void 0,arguments,"__kbdatacreatelisteners"),g=new n("add",c||d,b,arguments);!0!==k(g)&&!0!==r(b)&&(b=Object.getOwnPropertyDescriptor(a,d),Object.defineProperty(this,g.key,x(a,d,b)),g.type="postadd",k(g));return this}),prototype:b(function(a,d){void 0===this[a]?Object.defineProperty(this.__proto__,a,b(d,!0,!0)):console.error("Your attempting to add the your method with the prop: ",a," that already exists");return this}),set:b(function(a,
b,c){var e=new l(this,a,"set",b,this[a],arguments,"__kblisteners"),f=new n("set",a,e,arguments);void 0===this[a]?this.add(f.key,f.args[1]):!0!==k(f)&&(e.key=f.key,e.value=f.args[1],!0!==r(e)&&(void 0===Object.getOwnPropertyDescriptor(this,f.key).value?Object.getOwnPropertyDescriptor(this,f.key).set.call(this,f.args[1],c):Object.defineProperty(this,f.key,g.call(this,f.args[1],f.key)),f.type="postset",k(f)));return this}),remove:b(function(a){var b=new l(this,a,"remove",this[a],this[a],arguments,"__kbdatadeletelisteners"),
c=new n("remove",a,b,arguments);if(!0!==k(c)){if(void 0===this[c.key])return console.error("Your attempting to remove the property: ",c.key," that does not exist on ",this),this;!0!==r(b)&&(Object.defineProperty(this,c.key,{value:null,writable:!0,enumerable:!0,configurable:!0}),c.type="postremove",k(c))}return this}),stringify:b(function(){var a=[];return JSON.stringify(this,function(b,c){if(w(c)||p(c)){if(-1!==a.indexOf(c))return;a.push(c)}return c})}),callSubscribers:b(function(a,b,c){if(void 0!==
h[a]){c=0;for(var e=h[a].length;c<e;c++)h[a][c](b)}return this}),subscribe:b(function(a,b){void 0===h[a]&&(h[a]=[]);h[a].push(b);return this}),unsubscribe:b(function(a,b){if(void 0!==h[a]){var c=0,e=h[a].length;a:for(;c<e;c++)if(h[a][c].toString()===b.toString()){h[a].splice(c,1);break a}}return this}),__kblisteners:b({}),__kbupdatelisteners:b({}),__kbparentlisteners:b({}),__kbparentupdatelisteners:b({}),__kbdatacreatelisteners:b([]),__kbdatadeletelisteners:b([]),addActionListener:b(function(a,b){-1!==
Object.keys(m).indexOf(a)?m[a].push(b):console.error("There is no action listener by the name: ",a);return this}),removeActionListener:b(function(a,b){if(-1!==Object.keys(m).indexOf(a))for(var c=0,e=m[a],g=e.length;c!==g;c++){if(e[c].toString()===b.toString()){e.splice(c,1);break}}else console.error("There is no action listener by the name: ",a);return this}),onadd:b(function(){},!0),onremove:b(function(){},!0),onset:b(function(){},!0),onupdate:b(function(){},!0)});Object.defineProperties(f,{addDataListener:b(u("addDataListener",
"__kblisteners")),removeDataListener:b(q("removeDataListener","__kblisteners")),addDataUpdateListener:b(u("addDataUpdateListener","__kbupdatelisteners")),removeDataUpdateListener:b(q("removeDataUpdateListener","__kbupdatelisteners")),addDataCreateListener:b(u("addDataCreateListener","__kbdatacreatelisteners")),removeDataCreateListener:b(q("removeDataCreateListener","__kbdatacreatelisteners")),addDataRemoveListener:b(u("addDataRemoveListener","__kbdatadeletelisteners")),removeDataRemoveListener:b(q("removeDataRemoveListener",
"__kbdatadeletelisteners"))});return f}}(),A=function(z,t){return function(y){function l(b){return"[object Array]"===Object.prototype.toString.call(b)}function n(b){return"[object Object]"===Object.prototype.toString.call(b)}function u(b){return b.split(".").filter(function(b){return 0!==b.length})}function q(b,f){function h(b){f.splice(0,1);return 0===f.length?b:h(b[f[0]])}return(f=u(f))&&1!==f.length?h(b[f[0]]):f&&f.length?b[f[0]]:b}function p(b){if(1===b.key.split(".").length)return b.preventDefault(),
!1;q(b.event.local,b.key)[b.type](b.key,b.args[1])}function w(b){return function(f,h){function m(f,h,a){var d=Object.keys(f).filter(function(a){return n(f[a])||l(f[a])});void 0===f[b][h]&&(f[b][h]=[]);f[b][h].push(a);for(var c=0;c<d;c++)m(d[c],h,a)}m(this,f,h);return this}}function x(b){return function(f,h){function m(f,h,a){var d=Object.keys(f).filter(function(a){return n(f[a])||l(f[a])}),c=0,e=f[b][h].length;a:for(;c<e;c++)if(f[b][h][c].toString()===a.toString()){f[b][h].splice(c,1);break a}for(c=
0;c<d;c++)m(d[c],h,a)}m(this,f,h);return this}}var b={name:y};_data=t().addPointer(b,"name","__kbname");_data.prototype("updateName",function(g){"string"===typeof g&&(b.name=g);return this});_data.prototype("isArray",l).prototype("isObject",n).prototype("isObservable",function(b,f){return void 0===Object.getOwnPropertyDescriptor(b,f).vaue}).prototype("updateName",function(g){"string"===typeof g&&(b.name=g);return this}).prototype("getScopeByScopeString",q).prototype("addChildDataListener",w("__kbparentlisteners")).prototype("removeChildDataListener",
x("__kbparentlisteners")).prototype("addChildDataUpdateListener",w("__kbparentupdatelisteners")).prototype("removeChildDataUpdateListener",x("__kbparentupdatelisteners")).addActionListener("addDataListener",p).addActionListener("addDataUpdateListener",p).addActionListener("addDataCreateListener",p).addActionListener("addDataDeleteListener",p).addActionListener("removeDataListener",p).addActionListener("removeDataUpdateListener",p).addActionListener("removeDataCreateListener",p).addActionListener("removeDataDeleteListener",
p);return _data}}(C,D);window.define&&window.require?define([],function(){return A}):window.module&&(module.exports=A);return A}();
